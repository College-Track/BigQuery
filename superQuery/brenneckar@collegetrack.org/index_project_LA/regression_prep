WITH gahter_student_data AS (
  SELECT
    Contact_Id,
    indicator_completed_ct_hs_program_c,
    site_short,
    GPA_Cumulative_c,
    high_school_graduating_class_c
  FROM
    `data-warehouse-289815.salesforce_clean.contact_template`
  WHERE
    years_since_hs_grad_c >= 0
    AND college_track_status_c IN ('13A', '15A', '16A', '17A')
    AND CAST(high_school_graduating_class_c AS INT64) >= 2014
),

gather_first_gpa AS (


SELECT Contact_Id, 
 FIRST_VALUE(gpa_cumulative_c) OVER (PARTITION BY Contact_Id ORDER BY start_date_c DESC ) AS first_gpa,
  FIRST_VALUE(AT_Id) OVER (PARTITION BY Contact_Id ORDER BY start_date_c DESC ) AS term_id,
  FIRST_VALUE(grade_c) OVER (PARTITION BY Contact_Id ORDER BY start_date_c DESC ) AS grade

FROM `data-warehouse-289815.salesforce_clean.contact_at_template`
ORDER BY start_date_c
)

SELECT *
FROM gather_first_gpa
WHERE first_gpa > 0