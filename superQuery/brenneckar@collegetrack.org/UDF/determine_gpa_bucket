CREATE OR REPLACE FUNCTION `data-warehouse-289815.UDF.determine_buckets`(value FLOAT64, increment FLOAT64, low_number FLOAT64, high_number FLOAT64, bucket_type STRING) 
RETURNS STRING 
LANGUAGE js AS """
    if (value == null) {return "No Data"}
    else if (value <= low_number){return "<=" + low_number + bucket_type}
    else if (value >= high_number){return high_number + bucket_type + "+"}
    else if (value <= (low_number + increment * 1)){return (low_number) + bucket_type + "-" + (low_number + increment * 1) + bucket_type}
    else if (value <= (low_number + increment * 2)){return (low_number + increment * 1) + bucket_type + "-" + (low_number + increment * 2)+ bucket_type}
    else if (value <= (low_number + increment * 3)){return (low_number + increment * 2) + bucket_type + "-" + (low_number + increment * 3)+ bucket_type}
    else if (value <= (low_number + increment * 4)){return (low_number + increment * 3) + bucket_type + "-" + (low_number + increment * 4)+ bucket_type}
    else {return null};
    
""";