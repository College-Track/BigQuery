WITH student_data AS (
SELECT A_T.contact_id AS contact_id,full_name_c,act_composite_score_c, version_c, status_c, test_date_c, AT_grade_c, high_school_class_c

FROM `data-warehouse-289815.salesforce_clean.test_clean` AS test
LEFT JOIN `data-warehouse-289815.salesforce_clean.contact_at_template` AS A_T
    ON test.academic_semester_c = A_T.AT_id
    
)

SELECT Contact_Id
FROM student_Data as s1
WHERE act_composite_score_c = 
    (select max(act_composite_score_c) AS max_act 
    FROM student_Data as s2
    WHERE s1.contact_id = s2.contact_id
    AND version_c = 'Official'
    AND status_c = 'Completed'
    AND test_date_c <= '2019-02-28'
    AND AT_grade_c = '11th Grade'
    AND high_school_class_c = '2020')